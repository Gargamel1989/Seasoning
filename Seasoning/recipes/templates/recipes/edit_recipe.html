{% extends "base.html" %}

{% block title %}Recepten{% endblock %}

{% block extra_link %}
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
<style>
/*
 * Tooltip styles
 */
.ui-tooltip {
    position: absolute;
}

.ui-widget {
    font-family: Verdana,Arial,sans-serif;
    font-size: .75em;
    color: #5B6553;
}
</style>
{% endblock %}

{% block extra_script %}
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
<script src="{{ STATIC_URL }}js/forms.js"></script>
<script>
    $(document).tooltip({ 
        items: ".tooltip-field input,select,textarea", 
        content:  function() {
            return $(this).parent().children('.tooltip').text();
        },
        position: {
            my: "left top",
            at: "right+10 top-2"
        },  
    }).off("mouseover mouseout");
</script>
{% endblock %}

{% block page_name %}Recept {% if new_recipe %}Toevoegen{% else %}Aanpassen{% endif %}{% endblock %}


{% block content %}

<form id="add-recipe-form" action="" method="post" enctype="multipart/form-data">
  {% if unknown_ingredients %}
  <p>
  	U hebt ingredienten opgegeven in het recept die niet teruggevonden werden in onze databank:
  	<ul>
  		{% for unknown_ingredient in unknown_ingredients %}
  		<li>{{ unknown_ingredient }}</li>
  		{% endfor %}
  	</ul>
  	U hebt 3 mogelijkheden:
  	<ol>
  		<li>Het recept niet toevoegen</li>
  		<li>De ongekende ingredienten vervangen door andere, gelijkaardige ingredient die wel in onze databank terug
  			te vinden zijn</li>
  		<li>De ongekende ingredienten aanvragen. Uw recept zal opgeslagen worden, maar niet zichtbaar zijn voor andere
  			gebruikers, tot wij alle ongekende ingredienten in onze databank gestoken hebben. Let op dat dit geen simpel
  			proces is, en nogal wat tijd in beslag kan nemen.
  		</li>
  	</ol>
  	<input type="submit" value="Annuleren" name="stop-submit" /><input type="submit" value="Ingredienten Aanvragen" name="ingrequest-submit" />
  </p>
  {% endif %}
  
  {% csrf_token %}
  {{ form.non_field_errors }}
  
  <div class="field-wrapper tooltip-field">
    {{ recipe_form.name.label_tag }}
    {{ recipe_form.name }}
    <div class="tooltip">{{ recipe_form.name.help_text }}</div>
    
    {% if recipe_form.name.errors %}        
        {{ recipe_form.name.errors }} 
    {% endif %}
  </div>
  
  <div class="field-wrapper tooltip-field">
    {{ recipe_form.course.label_tag }}
    {{ recipe_form.course }}
    <div class="tooltip">{{ recipe_form.course.help_text }}</div>
    
    {% if recipe_form.course.errors %}        
        {{ recipe_form.course.errors }} 
    {% endif %}
  </div>
  
  <div class="field-wrapper tooltip-field">
    {{ recipe_form.cuisine.label_tag }}
    {{ recipe_form.cuisine }}
    <div class="tooltip">{{ recipe_form.cuisine.help_text }}</div>
    
    {% if recipe_form.cuisine.errors %}        
        {{ recipe_form.cuisine.errors }} 
    {% endif %}
  </div>
  
  <div class="field-wrapper tooltip-field">
    {{ recipe_form.description.label_tag }}
    {{ recipe_form.description }}
    <div class="tooltip">{{ recipe_form.description.help_text }}</div>
    
    {% if recipe_form.description.errors %}        
        {{ recipe_form.description.errors }} 
    {% endif %}
  </div>
  
  <div class="field-wrapper tooltip-field">
    {{ recipe_form.portions.label_tag }}
    {{ recipe_form.portions }}
    <div class="tooltip">{{ recipe_form.portions.help_text }}</div>
    
    {% if recipe_form.portions.errors %}        
        {{ recipe_form.portions.errors }} 
    {% endif %}
  </div>
  
  <div class="field-wrapper tooltip-field">
    {{ recipe_form.active_time.label_tag }}
    {{ recipe_form.active_time }}
    <div class="tooltip">{{ recipe_form.active_time.help_text }}</div>
    
    {% if recipe_form.active_time.errors %}        
        {{ recipe_form.active_time.errors }} 
    {% endif %}
  </div>
  
  <div class="field-wrapper tooltip-field">
    {{ recipe_form.passive_time.label_tag }}
    {{ recipe_form.passive_time }}
    <div class="tooltip">{{ recipe_form.passive_time.help_text }}</div>
    
    {% if recipe_form.passive_time.errors %}        
        {{ recipe_form.passive_time.errors }} 
    {% endif %}
  </div>
  
  <div class="field-wrapper tooltip-field">
    {{ recipe_form.extra_info.label_tag }}
    {{ recipe_form.extra_info }}
    <div class="tooltip">{{ recipe_form.extra_info.help_text }}</div>
    
    {% if recipe_form.extra_info.errors %}        
        {{ recipe_form.extra_info.errors }} 
    {% endif %}
  </div>
  
  <div class="field-wrapper tooltip-field">
    {{ recipe_form.instructions.label_tag }}
    {{ recipe_form.instructions }}
    <div class="tooltip">{{ recipe_form.instructions.help_text }}</div>
    
    {% if recipe_form.instructions.errors %}        
        {{ recipe_form.instructions.errors }} 
    {% endif %}
  </div>
  
  <div class="field-wrapper tooltip-field">
    {{ recipe_form.image.label_tag }}
    {{ recipe_form.image }}
    <div class="tooltip">{{ recipe_form.image.help_text }}</div>
    
    {% if recipe_form.image.errors %}        
        {{ recipe_form.image.errors }} 
    {% endif %}
  </div>
  
  <br /><br /><br /><br /><br /><br />
  
  <div id="uses-formset" class="formset">
      {{ usesingredient_formset.management_form }}
      <table>
        {% for form in usesingredient_formset %}
        {% if forloop.first %}
        <tr>
          <td><label>{{ form.ingredient.label }}</label></td>
          <td><label>{{ form.amount.label }}</label></td>
        </tr>
        {% endif %}
        <tr class="uses-form">
        {{ form.id }}
          <td>
    	{{ form.group.as_hidden }}
    	{{ form.ingredient }}
          </td>
          <td>
    	{{ form.amount }} {{ form.unit }}
          </td>
        </tr>    
        {% if form.non_field_errors %}
        <tr>
        	<td colspan=2>
        		{{ form.non_field_errors }}
        	</td>
    	</tr>
        {% endif %}
        {% endfor %}
        <tr class="empty uses-form">
          <td>
    	{{ usesingredient_formset.empty_form.group.as_hidden }}
    	{{ usesingredient_formset.empty_form.ingredient }}
          </td>
          <td>
    	{{ usesingredient_formset.empty_form.amount }} {{ usesingredient_formset.empty_form.unit }}
          </td>
        </tr>
                    <tr>
                        <td class="formset-button-container"> </td>
                    </tr>
      </table>
  </div>
  <input id="submit-btn" type="submit" value="{% if new_recipe %}Toevoegen{% else %}Aanpassen{% endif %}" name="normal-submit" />
</form>

{% endblock %}
