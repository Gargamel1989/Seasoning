{% extends "base.html" %}

{% block page_name %}Recept {% if new %}Toevoegen{% else %}Aanpassen{% endif %}{% endblock %}

{% block extrahead %}
    <script src="{{ STATIC_URL }}js/autocomplete_ingredients.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}js/formset.js" type="text/javascript"></script>
    <script type="text/javascript">
		$(document).ready(function() {
			$('#uses-addbtn').click(function() {
				return addForm(this, "uses");
			})});
	</script>
{% endblock %}


{% block content %}

<form action="" method="post" enctype="multipart/form-data">
  {% if unknown_ingredients %}
  <p>
  	U hebt ingredienten opgegeven in het recept die niet teruggevonden werden in onze databank:
  	<ul>
  		{% for unknown_ingredient in unknown_ingredients %}
  		<li>{{ unknown_ingredient }}</li>
  		{% endfor %}
  	</ul>
  	U hebt 3 mogelijkheden:
  	<ol>
  		<li>Het recept niet toevoegen</li>
  		<li>De ongekende ingredienten vervangen door andere, gelijkaardige ingredient die wel in onze databank terug
  			te vinden zijn</li>
  		<li>De ongekende ingredienten aanvragen. Uw recept zal opgeslagen worden, maar niet zichtbaar zijn voor andere
  			gebruikers, tot wij alle ongekende ingredienten in onze databank gestoken hebben. Let op dat dit geen simpel
  			proces is, en nogal wat tijd in beslag kan nemen.
  		</li>
  	</ol>
  	<input type="submit" value="Annuleren" name="stop-submit" /><input type="submit" value="Ingredienten Aanvragen" name="ingrequest-submit" />
  </p>
  {% endif %}
  
  {% csrf_token %}
  {{ recipe_form.non_field_errors }}
  {{ recipe_form.as_p }}
  {{ usesingredient_formset.management_form }}
  <table>
    {% for form in usesingredient_formset %}
    {% if forloop.first %}
    <tr>
      <td><label>{{ form.ingredient.label }}</label></td>
      <td><label>{{ form.amount.label }}</label></td>
    </tr>
    {% endif %}
    <tr class="uses-form">
    {{ form.id }}
      <td>
	{{ form.group.as_hidden }}
	{{ form.ingredient }}
      </td>
      <td>
	{{ form.amount }} {{ form.unit }}
      </td>
    </tr>    
    {% if form.non_field_errors %}
    <tr>
    	<td colspan=2>
    		{{ form.non_field_errors }}
    	</td>
	</tr>
    {% endif %}
    {% endfor %}
    <tr class="empty uses-form">
      <td>
	{{ usesingredient_formset.empty_form.group.as_hidden }}
	{{ usesingredient_formset.empty_form.ingredient }}
      </td>
      <td>
	{{ usesingredient_formset.empty_form.amount }} {{ usesingredient_formset.empty_form.unit }}
      </td>
    </tr>
    <tr>
		<td><a href="#" id="uses-addbtn"><img src="http://us.cdn1.123rf.com/168nwm/djordjer/djordjer1103/djordjer110300027/9107139-plus-chrome-button.jpg"></a></td>
	</tr>
  </table>
  
  <input id="submit-btn" type="submit" value="{% if new %}Toevoegen{% else %}Aanpassen{% endif %}" name="normal-submit" />
</form>

{% endblock %}
