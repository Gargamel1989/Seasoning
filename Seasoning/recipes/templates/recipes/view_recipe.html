{% extends "base.html" %}
{% load comments %}

{% block extrahead %}
    <link href="{{ STATIC_URL }}css/homepage.css" rel="stylesheet" type="text/css" media="screen" />
{% endblock %}

{% block content %}

{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

<h1>{{ recipe.name }}</h1>
<a href="/recipes/edit/{{ recipe.id }}/">Wijzigen</a><br/><br/>

<p>Auteur: {{ recipe.author.username }}</p>
<p>Tijdstip toegevoegd: {{ recipe.time_added }}</p>
<p><img src="{{ MEDIA_URL }}{{ recipe.image }}"/></p>
<p>Soort maaltijd: {{ recipe.get_course_display }}</p>
<p>Keuken: {{ recipe.cuisine }}</p>
<p>Beschrijving: {{ recipe.description }}</p>

<p>
  <a href="/recipes/{{ recipe.id }}/portions/1/">1</a> | 
1  <a href="/recipes/{{ recipe.id }}/portions/2/">2</a> | 
  <a href="/recipes/{{ recipe.id }}/portions/3/">3</a> | 
  <a href="/recipes/{{ recipe.id }}/portions/4/">4</a> | 
  <a href="/recipes/{{ recipe.id }}/portions/5/">5</a> | 
  <a href="/recipes/{{ recipe.id }}/portions/6/">6</a> | 
  <a href="/recipes/{{ recipe.id }}/portions/7/">7</a> | 
  <a href="/recipes/{{ recipe.id }}/portions/8/">8</a>
</p>
<p>
	Rating: {% if recipe.rating %}{{ recipe.rating }} ({{ recipe.number_of_votes }} stem{% if recipe.number_of_votes > 1 %}men{% endif %}){% else %}Dit recept heeft nog geen rating{% endif %}<br>
	Jouw Rating: 
	{% if not user.is_authenticated %}
		<a href="{% url 'auth_login' %}?next={{ request.path  }}">Meld je aan</a> om een rating te geven aan dit recept
	{% else %}
		<a href="/recipes/vote/{{ recipe.id }}/0/" {% ifequal user_vote.score 0 %}class="current-vote" style="font-weight: bold"{% endifequal %}>0</a>
		<a href="/recipes/vote/{{ recipe.id }}/1/" {% ifequal user_vote.score 1 %}class="current-vote" style="font-weight: bold"{% endifequal %}>1</a>
		<a href="/recipes/vote/{{ recipe.id }}/2/" {% ifequal user_vote.score 2 %}class="current-vote" style="font-weight: bold"{% endifequal %}>2</a>
		<a href="/recipes/vote/{{ recipe.id }}/3/" {% ifequal user_vote.score 3 %}class="current-vote" style="font-weight: bold"{% endifequal %}>3</a>
		<a href="/recipes/vote/{{ recipe.id }}/4/" {% ifequal user_vote.score 4 %}class="current-vote" style="font-weight: bold"{% endifequal %}>4</a>
		<a href="/recipes/vote/{{ recipe.id }}/5/" {% ifequal user_vote.score 5 %}class="current-vote" style="font-weight: bold"{% endifequal %}>5</a>
		{% if user_vote %}<a href="/recipes/removevote/{{ recipe.id }}/">Remove your vote</a>{% endif %}
{% endif %}
</p>
<p>Standaardporties: {{ recipe.portions }}</p>
<p>Actieve tijd: {{ recipe.active_time }}</p>
<p>Passieve tijd: {{ recipe.passive_time }}</p>
<p>Extra Info: {{ recipe.extra_info }}</p>
<p>Totale voetafdruk: {{ recipe.footprint }} kgCO2 ({{ recipe.footprint_pp }} pp.)</p>

<p>
	Ingredienten:<br>
	{% for uses in usess %}
		<a href="/ingredients/{{ uses.ingredient.id }}/">{{ uses.ingredient.name }}</a> - {{ uses.amount }} {{ uses.unit.short_name}} ({{ uses.ingredient.footprint }} kgCO2/{{ uses.ingredient.primary_unit.unit.short_name }} -> {{ uses.footprint }} kgCO2)<br>
		{% for avail in uses.ingredient.available_in_country.all %}
		--- Kan komen van {{ avail.country.name }} met transportmethode: {{ avail.transport_method.name }} tussen {{ avail.month_from }} en {{ avail.month_until }} (Uitstoot van deze optie: {{ avail.footprint }} kgCO2/{{ uses.ingredient.primary_unit.unit.short_name }})<br>
		{% endfor %}
	{% endfor %}
</p>

<p>Bereidingswijze:
	<br>
	{{ recipe.instructions }}	
</p>

<p>Geef een reactie op dit recept:
	<br>
	{% if user.is_authenticated %}
	    {% get_comment_form for recipe as form %}
	    <form action="{% comment_form_target %}" method="POST">
		    {% csrf_token %}
		    {{ form.comment }}
		    {{ form.honeypot }}
		    {{ form.content_type }}
		    {{ form.object_pk }}
		    {{ form.timestamp }}
		    {{ form.security_hash }}
		    <input type="hidden" name="next" value="{{ request.path }}" />
		    <br><input type="submit" value="Add comment" id="id_submit" />
	    </form>
	{% else %}
	    <p><a href="{% url 'auth_login' %}?next={{ request.path  }}">Meld je aan</a> om een reactie te geven.</p>
	{% endif %}
</p>
<p>
	{% get_comment_count for recipe as comment_count  %}
	{% ifequal comment_count 0 %}
	Er zijn nog geen reacties op dit recept... Wees de eerste!
	{% else %}
		{% ifequal comment_count 1 %}
		Er is 1 reactie op dit recept:
		{% else %}
		Er zijn {{ comment_count }} reacties op dit recept:
		{% endifequal %}
	{% endifequal %}
	<br>
	{% render_comment_list for recipe %}
</p>

{% endblock %}
