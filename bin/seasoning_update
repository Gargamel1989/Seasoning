#!/bin/sh

cd $SEASONING_HOME/seasoning_website
git pull -q git://github.com/Gargamel1989/Seasoning.git master


if [ -n "$1" ]; then
  git tag | grep $1
  if [[ $? -eq 0 ]]; then
    SEASONING_VERSION=$1
  else
    echo "Requested version does not exist, using version $SEASONING_VERSION"
  fi
fi

git checkout -q $SEASONING_VERSION

sh $SEASONING_HOME/seasoning_website/environment/prepare_and_install_seasoning_source.sh

# Collect static files
$SEASONING_HOME/seasoning_env/bin/python $SEASONING_HOME/seasoning_website/Seasoning/manage.py collectstatic
